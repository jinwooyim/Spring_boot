<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.boot.dao.RecipePageDAO">

<sql id="criteria">
<!--	1번 방법-->
<!--	<if test="type == 'T'.toString()"></if>-->
<!--	2번 방법-->
	<if test='type == "T"'>
		where rc_boardTitle like concat('%', #{keyword}, '%')
	</if>
	<if test='type == "C"'>
		where rc_boardContent like concat('%', #{keyword}, '%')
	</if>
	<if test='type == "W"'>
		where rc_boardName like concat('%', #{keyword}, '%')
	</if>
	<if test='type == "TC"'>
		where rc_boardTitle like concat('%', #{keyword}, '%') or rc_boardContent like concat('%', #{keyword}, '%')
	</if>
	<if test='type == "TW"'>
		where rc_boardTitle like concat('%', #{keyword}, '%') or rc_boardName like concat('%', #{keyword}, '%')
	</if>
	<if test='type == "TCW"'>
		where rc_boardTitle like concat('%', #{keyword}, '%') or rc_boardContent like concat('%', #{keyword}, '%') or rc_boardName like concat('%', #{keyword}, '%')
	</if>
</sql>
    <select id="listWithPaging" resultType="com.boot.dto.RecipeBoardDTO">
	 	<![CDATA[ 
	 	select rc_boardNo, rc_boardName, rc_boardTitle,rc_boardContent,rc_boardDate,rc_boardHit
		from(select rownum, rc_boardNo, rc_boardName, rc_boardTitle,rc_boardContent,rc_boardDate,rc_boardHit 
			from(select row_number() over(order by rc_boardNo desc) as rownum, rc_boardNo, rc_boardName, rc_boardTitle,rc_boardContent,rc_boardDate,rc_boardHit 
					from rc_board
					]]>
					<include refid="criteria"></include>
					<![CDATA[
					order by rc_boardNo desc
		        ) a 
			where rownum <= (#{pageNum}*#{amount})
		) aa
		where rownum > ((#{pageNum}-1)*#{amount})
	 	]]>
    </select>
    
	<select id="totalList" resultType="int">
	    select count(*) from rc_board
	    <include refid="criteria"></include>
	</select>
</mapper>


